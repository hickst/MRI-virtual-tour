<!DOCTYPE html>
<html>

<head>
  <!-- this imports the aframe package that we use for web vr -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="/src/components/acomponents.js"></script>
  <link rel="stylesheet" href="/src/components/acomponents.css"></script>
</head>

<body>
  <!-- this holds the spinner when the scene is loading instead of just showing a blank page -->
  <div id="loaderHolder">
    <div class="loader"></div>
  </div>

  <!-- this is the parent of the entire vr tour scene -->
  <!-- since we want the mouse to trigger things we set up the cursor this way,
       then we can trigger things like mouse interactions on elements we customized to listen -->
  <a-scene loading-screen="dotsColor: black; backgroundColor: white" cursor="rayOrigin: mouse">


    <!-- this is where we load in the various things we will use for the scene
         * the 360 image gets placed on the sky entity,
         * the info and arrow icons get used on the circles, placed around the scene,
         * the anchors glb is a file that we used to make sure the elements get placed in the
         right locations when Aframe starts.
      -->
    <a-assets>
      <img id="console-image" src="/public/console.jpg" />
      <img id="info" src="/src/assets/info.png" />
      <img id="arrow" src="/src/assets/arrow.png" />

      <a-asset-item id="anchors" src="/public/anchor.glb"></a-asset-item>
    </a-assets>


    <!-- adding in a entity that holds the camera, this is preferable to adding a
         simple camera as it allows for more extension later for whatever reason
         in blender the camera uses a different coordinate system, so the no rotation
         aplied means that the cam looks down the blender y axis
      -->
    <a-entity id="maincam" rotation="0 -180 0" position="0 0 0">
      <a-camera look-controls></a-camera>
    </a-entity>

    <!-- here's the fun parts, we are using an entity and putting a different entity
         inside it this lets us add our custom anchor-reader to the thing that loads
         the anchors model then our anchor reader is also going to use it's code to
         update the position and rotation of it's first child,
         in this case that is the circle element
      -->
    <a-entity anchor-reader="anchorName:Machine" gltf-model="#anchors">

      <!-- here we define the circle with standard shadeless double sided material
           using our info icon loaded in the assets, we actually use the id of the
           asset element to refer to it simply here we will also be using the
           mlisten component to pass information about what should happen when people
           interact with the entity using a mouse
        -->
      <a-circle mlisten="htmlFile:/public/popout.html"
                material="side:double;src:#info;shader:flat">
      </a-circle>
    </a-entity>

    <a-entity anchor-reader="anchorName:machinedoor" gltf-model="#anchors">
      <a-circle mlisten="htmlFile:/public/popout.html"
                material="side:double;src:#info;shader:flat">
      </a-circle>
    </a-entity>

    <a-entity anchor-reader="anchorName:enterscanner" gltf-model="#anchors">
      <a-circle mlisten="htmlFile:/public/enter_scanner.html;movement:true"
                material="side:double;src:#arrow;shader:flat">
      </a-circle>
    </a-entity>

    <!-- this is the element that controls the popout dynamics. The mlisten is a component
         we defined to react to mouse over and click events-->
    <a-sky src="#console-image"></a-sky>
  </a-scene>

</body>

</html>
